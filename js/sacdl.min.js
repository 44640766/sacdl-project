var Utils=function(){function e(e,n){for(var a in n)"undefined"==typeof e[a]&&(e[a]=n[a])}var n,a=[];return{init:function(e){n=e},getBarData:function(){var e=this.getTreeData(),n=e.children,a={labels:[],series:[]},r=[];return n.forEach(function(e){a.labels.push(e.name),r.push(e.children.length)}),a.series.push({label:"Projects count",values:r}),a},getTreeData:function(){var r={};if(e(n,{name:"languages",children:[]}),n&&n.items){a=n.items,a.forEach(function(e,n){"undefined"==typeof r[e.language]&&(r[e.language]=n)});for(var t in r){var i={name:t,children:[]};a.forEach(function(e,n){var a={name:e.full_name,watchers_count:e.watchers_count,forks_count:e.forks_count,size:0};e.language===t&&i.children.push(a)}),n.children.push(i)}}return delete n.items,n}}}();
var Searcher=function(){function t(){var t=e.property("value")||c.q;return s=r+c.type+"?q="+t+"&sort="+c.sort+"&order="+c.order,console.log(s),s}var r,e,o,s="",n=[],c={type:"repositories",q:"bitcoin",sort:"stars",order:"desc"};return{settings:{baseApiUrl:"https://api.github.com/search/"},init:function(){e=d3.select("#search-input"),o=d3.select("#search-btn"),r=this.settings.baseApiUrl,o.on("click",function(){t(),n.forEach(function(t){try{t(s)}catch(r){console.log(r)}})})},addListener:function(t){n.push(t)}}}();
var Bar=function(){function t(t){for(var e=0;e<t.labels.length;e++)for(var r=0;r<t.series.length;r++)g.push(t.series[r].values[e])}function e(){g=[],a=Utils.getBarData(),i=l*a.series.length,t(a);var e=d3.scale.category20(),r=l*g.length+c*a.labels.length,h=d3.scale.linear().domain([0,d3.max(g)]).range([0,s]),u=d3.scale.linear().range([r+c,0]);n=d3.svg.axis().scale(u).tickFormat("").tickSize(0).orient("left");var f=chart.attr("width",o+s+d).attr("height",r),p=f.selectAll("g").data(g),x=p.enter().append("g").attr("transform",function(t,e){return"translate("+o+","+(e*l+c*(.5+Math.floor(e/a.series.length)))+")"});x.append("rect").attr("fill",function(t,r){return e(r%a.series.length)}).attr("class","bar").attr("width",h).attr("height",l-1),x.append("text").attr("x",function(t){return h(t)-3}).attr("y",l/2).attr("fill","red").attr("dy",".35em").text(function(t){return t}),x.append("text").attr("class","label").attr("x",function(t){return-10}).attr("y",i/2).attr("dy",".35em").text(function(t,e){return e%a.series.length===0?a.labels[Math.floor(e/a.series.length)]:""}),p.exit().transition().style({opacity:0}).remove(),f.append("g").attr("class","y axis").attr("transform","translate("+o+", "+-c/2+")").call(n);var v=18,b=4,y=f.selectAll(".legend").data(a.series),m=y.enter().append("g").attr("transform",function(t,e){var r=v+b,a=-c/2,n=o+s+40-v,l=e*r-a;return"translate("+n+","+l+")"});m.append("rect").attr("width",v).attr("height",v).style("fill",function(t,r){return e(r)}).style("stroke",function(t,r){return e(r)}),m.append("text").attr("class","legend").attr("x",v+b).attr("y",v-b).text(function(t){return t.label}),y.exit().remove()}var r,a,n,s=300,l=20,i=0,c=10,o=150,d=150,g=[];return{settings:{title:"barTitle",desc:"barDesc",barId:"#barId"},init:function(){r=this.settings.barId,d3.select("#barTitle").text(this.settings.title),d3.select("#barDesc").text(this.settings.desc),chart=d3.select(r).append("svg:svg").attr("class","chart")},show:function(){e()}}}();
var Treemap=function(){function t(t){c=a=[],c=a=Utils.getTreeData(t);var u=i.nodes(a).filter(function(t){return!t.children}),o=s.selectAll("g").data(u).enter().append("svg:g").attr("class","cell").attr("transform",function(t){return"translate("+t.x+","+t.y+")"}).on("click",function(t){return r(c==t.parent?a:t.parent)});o.append("svg:rect").attr("width",function(t){return t.dx-1}).attr("height",function(t){return t.dy-1}).style("fill",function(t){return f(t.parent.name)}),o.append("svg:text").attr("x",function(t){return t.dx/2}).attr("y",function(t){return t.dy/2}).attr("dy",".35em").attr("text-anchor","middle").text(function(t){return t.name+" "+t.watchers_count}).style("opacity",function(t){return t.w=this.getComputedTextLength(),t.dx>t.w?1:0}),d3.select(window).on("click",function(){r(a)}),d3.select("#treemapSelect").on("change",function(){i.value("watchers"==this.value?e:n).nodes(a),r(c)})}function e(t){return t.watchers_count}function n(t){return t.forks_count}function r(t){var e=u/t.dx,n=o/t.dy;d.domain([t.x,t.x+t.dx]),l.domain([t.y,t.y+t.dy]);var r=s.selectAll("g.cell").transition().duration(d3.event.altKey?7500:750).attr("transform",function(t){return"translate("+d(t.x)+","+l(t.y)+")"});r.select("rect").attr("width",function(t){return e*t.dx-1}).attr("height",function(t){return n*t.dy-1}),r.select("text").attr("x",function(t){return e*t.dx/2}).attr("y",function(t){return n*t.dy/2}).style("opacity",function(t){return e*t.dx>t.w?1:0}),c=t,d3.event.stopPropagation()}var a,c,i,s,u=970,o=500,d=d3.scale.linear().range([0,u]),l=d3.scale.linear().range([0,o]),f=d3.scale.category20c();return{settings:{title:"treemapTitle",desc:"treemapDesc",treemapId:"#treemapId"},init:function(){var t=this.settings.treemapId;d3.select("#treemapTitle").text(this.settings.title),d3.select("#treemapDesc").text(this.settings.desc),i=d3.layout.treemap().round(!1).size([u,o]).sticky(!0).value(function(t){return t.watchers_count}),s=d3.select(t).append("div").attr("class","chart").style("width",u+"px").style("height",o+"px").append("svg:svg").attr("width",u).attr("height",o).append("svg:g").attr("transform","translate(.5,.5)")},show:function(e){t(e)}}}();
!function(){function e(e){var i=setTimeout(function(){t.style.display="block"},300);d3.json(e,function(e,a){e&&(clearTimeout(i),t.style.display="none",alert("加载数据失败，请检查您的网络设置。")),Utils.init(a),Bar.show(),Treemap.show(),clearTimeout(i),t.style.display="none"})}var t=document.getElementById("modal");Searcher.init(),Bar.settings={title:"Top100 BarChart",desc:"This is a good example.",barId:"#barId"},Bar.init(),Treemap.settings={title:"Top100 treemap",desc:"You can click the block to zoom it.",treemapId:"#sacdlTreemap"},Treemap.init(),e("https://api.github.com/search/repositories?q=bitcoin")}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInV0aWxzLmpzIiwic2VhcmNoZXIuanMiLCJiYXIuanMiLCJ0cmVlbWFwLmpzIiwiYXBwLmpzIl0sIm5hbWVzIjpbIlV0aWxzIiwibWVyZ2VUbyIsInRvIiwiZnJvbSIsImtleSIsImRhdGFTZXQiLCJpdGVtcyIsImluaXQiLCJkYXRhIiwiZ2V0QmFyRGF0YSIsInRyZWVEYXRhIiwidGhpcyIsImdldFRyZWVEYXRhIiwiY2hpbGRyZW4iLCJyZXN1bHQiLCJsYWJlbHMiLCJzZXJpZXMiLCJ2YWx1ZXMiLCJmb3JFYWNoIiwiaXRlbSIsInB1c2giLCJuYW1lIiwibGVuZ3RoIiwibGFiZWwiLCJsYW5ndWFnZXMiLCJpbmRleCIsImxhbmd1YWdlIiwicm9vdCIsImNoaWxkIiwiZnVsbF9uYW1lIiwid2F0Y2hlcnNfY291bnQiLCJmb3Jrc19jb3VudCIsInNpemUiLCJTZWFyY2hlciIsInBhcnNlUXVlcnkiLCJxIiwiaW5wdXRUeHQiLCJwcm9wZXJ0eSIsInF1ZXJ5IiwidXJsIiwiYmFzZUFwaVVybCIsImNvbnNvbGUiLCJsb2ciLCJzZWFyY2hCdG4iLCJsaXN0ZW5lcnMiLCJ0eXBlIiwic29ydCIsIm9yZGVyIiwic2V0dGluZ3MiLCJkMyIsInNlbGVjdCIsIm9uIiwibGlzdGVuZXIiLCJlcnJvciIsImFkZExpc3RlbmVyIiwiQmFyIiwiemlwcGluZ0RhdGEiLCJpIiwiaiIsInppcHBlZERhdGEiLCJzaG93QmFyIiwiZ3JvdXBIZWlnaHQiLCJiYXJIZWlnaHQiLCJjb2xvciIsInNjYWxlIiwiY2F0ZWdvcnkyMCIsImNoYXJ0SGVpZ2h0IiwiZ2FwQmV0d2Vlbkdyb3VwcyIsIngiLCJsaW5lYXIiLCJkb21haW4iLCJtYXgiLCJyYW5nZSIsImNoYXJ0V2lkdGgiLCJ5IiwieUF4aXMiLCJzdmciLCJheGlzIiwidGlja0Zvcm1hdCIsInRpY2tTaXplIiwib3JpZW50IiwiY2hhcnQiLCJhdHRyIiwic3BhY2VGb3JMYWJlbHMiLCJzcGFjZUZvckxlZ2VuZCIsImJhck5vZGVzIiwic2VsZWN0QWxsIiwiYmFyIiwiZW50ZXIiLCJhcHBlbmQiLCJkIiwiTWF0aCIsImZsb29yIiwidGV4dCIsImV4aXQiLCJ0cmFuc2l0aW9uIiwic3R5bGUiLCJvcGFjaXR5IiwicmVtb3ZlIiwiY2FsbCIsImxlZ2VuZFJlY3RTaXplIiwibGVnZW5kU3BhY2luZyIsImxlZ2VuZERhdGEiLCJsZWdlbmQiLCJoZWlnaHQiLCJvZmZzZXQiLCJob3J6IiwidmVydCIsImJhcklkIiwidGl0bGUiLCJkZXNjIiwic2hvdyIsIlRyZWVtYXAiLCJzaG93Q2hhcnQiLCJub2RlIiwibm9kZXMiLCJ0cmVlbWFwIiwiZmlsdGVyIiwiY2VsbCIsInpvb20iLCJwYXJlbnQiLCJkeCIsImR5IiwidyIsImdldENvbXB1dGVkVGV4dExlbmd0aCIsIndpbmRvdyIsInZhbHVlIiwiY291bnQiLCJreCIsImt5IiwiaCIsInQiLCJkdXJhdGlvbiIsImV2ZW50IiwiYWx0S2V5Iiwic3RvcFByb3BhZ2F0aW9uIiwiY2F0ZWdvcnkyMGMiLCJ0cmVlbWFwSWQiLCJsYXlvdXQiLCJyb3VuZCIsInN0aWNreSIsImxvYWRlciIsInNldFRpbWVvdXQiLCJsb2FkaW5nIiwiZGlzcGxheSIsImpzb24iLCJlcnIiLCJjbGVhclRpbWVvdXQiLCJhbGVydCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiXSwibWFwcGluZ3MiOiJBQUFBLEdBQUlBLE9BQVMsV0F5R1QsUUFBU0MsR0FBUUMsRUFBSUMsR0FDakIsSUFBSyxHQUFJQyxLQUFPRCxHQUNXLG1CQUFaRCxHQUFHRSxLQUNWRixFQUFHRSxHQUFPRCxFQUFLQyxJQTNHM0IsR0FBSUMsR0FDQUMsSUFFSixRQUVJQyxLQUFNLFNBQVNDLEdBQ1hILEVBQVVHLEdBZ0JkQyxXQUFZLFdBQ1IsR0FBSUMsR0FBV0MsS0FBS0MsY0FDaEJOLEVBQVFJLEVBQVNHLFNBQ2pCQyxHQUNJQyxVQUNBQyxXQUVKQyxJQVlKLE9BVkFYLEdBQU1ZLFFBQVEsU0FBU0MsR0FDbkJMLEVBQU9DLE9BQU9LLEtBQUtE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WHJELElBQUloRCxPQUtKeUcsUUFBUWhFLFVBQ0o2RCxNQUFPLGlCQUNQQyxLQUFNLHNDQUNOMkIsVUFBVyxpQkFFZnpCLFFBQVF6RyxPQTJCUndHLEVBQUsiLCJmaWxlIjoic2FjZGwubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIFV0aWxzID0gKGZ1bmN0aW9uKCkge1xuICAgIHZhciBkYXRhU2V0LFxuICAgICAgICBpdGVtcyA9IFtdO1xuXG4gICAgcmV0dXJuIHtcblxuICAgICAgICBpbml0OiBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICBkYXRhU2V0ID0gZGF0YTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgIERhdGEgZm9ybWF0OlxuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbHM6IFtcbiAgICAgICAgICAgICAgICAnYy9jKysnLCAncHl0aG9uJywgJ2phdmFzY3JpcHQnLFxuICAgICAgICAgICAgICAgICdqYXZhJywgJ3J1YnknLCAnaHRtbCdcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICBzZXJpZXM6IFt7XG4gICAgICAgICAgICAgICAgbGFiZWw6ICdQcm9qZWN0cyBjb3VudCcsXG4gICAgICAgICAgICAgICAgdmFsdWVzOiBbNCwgOCwgMTUsIDE2LCAyMywgNDJdIC8vY291bnRzXG4gICAgICAgICAgICB9XVxuICAgICAgICB9XG4gICAgICAgICovXG4gICAgICAgIGdldEJhckRhdGE6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIHRyZWVEYXRhID0gdGhpcy5nZXRUcmVlRGF0YSgpOyAvL29yIGRhdGFTZXRcbiAgICAgICAgICAgIHZhciBpdGVtcyA9IHRyZWVEYXRhLmNoaWxkcmVuO1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgbGFiZWxzOiBbXSxcbiAgICAgICAgICAgICAgICAgICAgc2VyaWVzOiBbXVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWVzID0gW107XG5cbiAgICAgICAgICAgIGl0ZW1zLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICAgICAgICAgIHJlc3VsdC5sYWJlbHMucHVzaChpdGVtLm5hbWUpO1xuICAgICAgICAgICAgICAgIHZhbHVlcy5wdXNoKGl0ZW0uY2hpbGRyZW4ubGVuZ3RoKTtcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgIHJlc3VsdC5zZXJpZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgbGFiZWw6ICdQcm9qZWN0cyBjb3VudCcsXG4gICAgICAgICAgICAgICAgdmFsdWVzOiB2YWx1ZXNcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIERhdGEgZm9ybWF0OlxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJsYW5ndWFnZXNcIixcbiAgICAgICAgICAgICAgICAgICAgXCJjaGlsZHJlblwiOiBbe1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwiamF2YXNjcmlwdFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJjaGlsZHJlblwiOiBbe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcImltZmx5L215SURFXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ3YXRjaGVyc19jb3VudFwiOiAxMDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJmb3Jrc19jb3VudFwiOiA1MCBcInNpemVcIjogMjBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1dXG4gICAgICAgICAgICAgICAgICAgIH1dXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICovXG5cbiAgICAgICAgZ2V0VHJlZURhdGE6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIGxhbmd1YWdlcyA9IHt9O1xuXG4gICAgICAgICAgICBtZXJnZVRvKGRhdGFTZXQsIHtcbiAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJsYW5ndWFnZXNcIixcbiAgICAgICAgICAgICAgICBcImNoaWxkcmVuXCI6IFtdXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaWYgKGRhdGFTZXQgJiYgZGF0YVNldC5pdGVtcykge1xuICAgICAgICAgICAgICAgIGl0ZW1zID0gZGF0YVNldC5pdGVtcztcblxuICAgICAgICAgICAgICAgIGl0ZW1zLmZvckVhY2goZnVuY3Rpb24oaXRlbSwgaW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBsYW5ndWFnZXNbaXRlbS5sYW5ndWFnZV0gPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhbmd1YWdlc1tpdGVtLmxhbmd1YWdlXSA9IGluZGV4O1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBsYW5ndWFnZSBpbiBsYW5ndWFnZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJvb3QgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIjogbGFuZ3VhZ2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImNoaWxkcmVuXCI6IFtdXG4gICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgaXRlbXMuZm9yRWFjaChmdW5jdGlvbihpdGVtLCBpbmRleCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNoaWxkID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBpdGVtLmZ1bGxfbmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIndhdGNoZXJzX2NvdW50XCI6IGl0ZW0ud2F0Y2hlcnNfY291bnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJmb3Jrc19jb3VudFwiOiBpdGVtLmZvcmtzX2NvdW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2l6ZVwiOiAwXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbS5sYW5ndWFnZSA9PT0gbGFuZ3VhZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb290LmNoaWxkcmVuLnB1c2goY2hpbGQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgICAgICAgICBkYXRhU2V0LmNoaWxkcmVuLnB1c2gocm9vdCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBkZWxldGUgZGF0YVNldC5pdGVtcztcbiAgICAgICAgICAgIHJldHVybiBkYXRhU2V0O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy9wcm92aXRlIG1ldGhvZHNcbiAgICBmdW5jdGlvbiBtZXJnZVRvKHRvLCBmcm9tKSB7XG4gICAgICAgIGZvciAodmFyIGtleSBpbiBmcm9tKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHRvW2tleV0gPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICAgICAgICB0b1trZXldID0gZnJvbVtrZXldXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbn0oKSlcbiIsInZhciBTZWFyY2hlciA9IChmdW5jdGlvbigpIHtcbiAgICB2YXIgdXJsID0gJycsXG4gICAgICAgIGJhc2VBcGlVcmwsXG4gICAgICAgIGlucHV0VHh0LFxuICAgICAgICBzZWFyY2hCdG4sXG4gICAgICAgIGxpc3RlbmVycyA9IFtdLFxuICAgICAgICBxdWVyeSA9IHtcbiAgICAgICAgICAgIHR5cGU6ICdyZXBvc2l0b3JpZXMnLFxuICAgICAgICAgICAgcTogJ2JpdGNvaW4nLFxuICAgICAgICAgICAgc29ydDogXCJzdGFyc1wiLFxuICAgICAgICAgICAgb3JkZXI6IFwiZGVzY1wiXG4gICAgICAgIH07XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBzZXR0aW5nczoge1xuICAgICAgICAgICAgYmFzZUFwaVVybDogJ2h0dHBzOi8vYXBpLmdpdGh1Yi5jb20vc2VhcmNoLydcbiAgICAgICAgfSxcblxuICAgICAgICBpbml0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlucHV0VHh0ID0gZDMuc2VsZWN0KCcjc2VhcmNoLWlucHV0Jyk7XG4gICAgICAgICAgICBzZWFyY2hCdG4gPSBkMy5zZWxlY3QoJyNzZWFyY2gtYnRuJyk7XG4gICAgICAgICAgICBiYXNlQXBpVXJsID0gdGhpcy5zZXR0aW5ncy5iYXNlQXBpVXJsO1xuXG4gICAgICAgICAgICBzZWFyY2hCdG4ub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgcGFyc2VRdWVyeSgpO1xuICAgICAgICAgICAgICAgIGxpc3RlbmVycy5mb3JFYWNoKGZ1bmN0aW9uKGxpc3RlbmVyKSB7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsaXN0ZW5lcih1cmwpO1xuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBhZGRMaXN0ZW5lcjogZnVuY3Rpb24obGlzdGVuZXIpIHtcbiAgICAgICAgICAgIGxpc3RlbmVycy5wdXNoKGxpc3RlbmVyKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBmdW5jdGlvbiBwYXJzZVF1ZXJ5KCkge1xuICAgICAgICB2YXIgcSA9IGlucHV0VHh0LnByb3BlcnR5KCd2YWx1ZScpIHx8IHF1ZXJ5WydxJ107XG5cbiAgICAgICAgLy8gZm9yICh2YXIga2V5IGluIHF1ZXJ5KSB7XG4gICAgICAgIHVybCA9IGJhc2VBcGlVcmwgKyBxdWVyeVsndHlwZSddICsgJz8nICsgJ3E9JyArIHEgKyAnJnNvcnQ9JyArIHF1ZXJ5Wydzb3J0J10gKyAnJm9yZGVyPScgKyBxdWVyeVsnb3JkZXInXTtcbiAgICAgICAgLy8gfTtcbiAgICAgICAgY29uc29sZS5sb2codXJsKTtcblxuICAgICAgICByZXR1cm4gdXJsO1xuICAgIH1cbn0oKSlcbiIsInZhciBCYXIgPSAoZnVuY3Rpb24oKSB7XG4gICAgdmFyIGNoYXJ0V2lkdGggPSAzMDAsXG4gICAgICAgIGJhckhlaWdodCA9IDIwLFxuICAgICAgICBncm91cEhlaWdodCA9IDAsXG4gICAgICAgIGdhcEJldHdlZW5Hcm91cHMgPSAxMCxcbiAgICAgICAgc3BhY2VGb3JMYWJlbHMgPSAxNTAsXG4gICAgICAgIHNwYWNlRm9yTGVnZW5kID0gMTUwLFxuICAgICAgICBiYXJJZCxcbiAgICAgICAgc3ZnLFxuICAgICAgICBkYXRhLFxuICAgICAgICB5QXhpcztcblxuICAgIC8vIFppcCB0aGUgc2VyaWVzIGRhdGEgdG9nZXRoZXIgKGZpcnN0IHZhbHVlcywgc2Vjb25kIHZhbHVlcywgZXRjLilcbiAgICB2YXIgemlwcGVkRGF0YSA9IFtdO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgc2V0dGluZ3M6IHtcbiAgICAgICAgICAgIHRpdGxlOiBcImJhclRpdGxlXCIsXG4gICAgICAgICAgICBkZXNjOiBcImJhckRlc2NcIixcbiAgICAgICAgICAgIGJhcklkOiBcIiNiYXJJZFwiXG4gICAgICAgIH0sXG5cbiAgICAgICAgaW5pdDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBiYXJJZCA9IHRoaXMuc2V0dGluZ3MuYmFySWQ7XG5cbiAgICAgICAgICAgIGQzLnNlbGVjdChcIiNiYXJUaXRsZVwiKS50ZXh0KHRoaXMuc2V0dGluZ3MudGl0bGUpO1xuICAgICAgICAgICAgZDMuc2VsZWN0KFwiI2JhckRlc2NcIikudGV4dCh0aGlzLnNldHRpbmdzLmRlc2MpO1xuXG4gICAgICAgICAgICAvLyBTcGVjaWZ5IHRoZSBjaGFydCBhcmVhIGFuZCBkaW1lbnNpb25zXG4gICAgICAgICAgICBjaGFydCA9IGQzLnNlbGVjdChiYXJJZCkuYXBwZW5kKFwic3ZnOnN2Z1wiKVxuICAgICAgICAgICAgICAgIC5hdHRyKFwiY2xhc3NcIiwgXCJjaGFydFwiKVxuICAgICAgICB9LFxuXG4gICAgICAgIHNob3c6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgc2hvd0JhcigpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gemlwcGluZ0RhdGEoZGF0YSkge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGEubGFiZWxzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGRhdGEuc2VyaWVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgemlwcGVkRGF0YS5wdXNoKGRhdGEuc2VyaWVzW2pdLnZhbHVlc1tpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzaG93QmFyKCkge1xuICAgICAgICAvL2NsZWFuIGRhdGE7XG4gICAgICAgIHppcHBlZERhdGEgPSBbXTtcblxuICAgICAgICBkYXRhID0gVXRpbHMuZ2V0QmFyRGF0YSgpO1xuICAgICAgICBncm91cEhlaWdodCA9IGJhckhlaWdodCAqIGRhdGEuc2VyaWVzLmxlbmd0aDtcblxuICAgICAgICB6aXBwaW5nRGF0YShkYXRhKTtcblxuICAgICAgICAvLyBDb2xvciBzY2FsZVxuICAgICAgICB2YXIgY29sb3IgPSBkMy5zY2FsZS5jYXRlZ29yeTIwKCk7XG4gICAgICAgIHZhciBjaGFydEhlaWdodCA9IGJhckhlaWdodCAqIHppcHBlZERhdGEubGVuZ3RoICsgZ2FwQmV0d2Vlbkdyb3VwcyAqIGRhdGEubGFiZWxzLmxlbmd0aDtcblxuICAgICAgICB2YXIgeCA9IGQzLnNjYWxlLmxpbmVhcigpXG4gICAgICAgICAgICAuZG9tYWluKFswLCBkMy5tYXgoemlwcGVkRGF0YSldKVxuICAgICAgICAgICAgLnJhbmdlKFswLCBjaGFydFdpZHRoXSk7XG5cbiAgICAgICAgdmFyIHkgPSBkMy5zY2FsZS5saW5lYXIoKVxuICAgICAgICAgICAgLnJhbmdlKFtjaGFydEhlaWdodCArIGdhcEJldHdlZW5Hcm91cHMsIDBdKTtcblxuICAgICAgICB5QXhpcyA9IGQzLnN2Zy5heGlzKClcbiAgICAgICAgICAgIC5zY2FsZSh5KVxuICAgICAgICAgICAgLnRpY2tGb3JtYXQoJycpXG4gICAgICAgICAgICAudGlja1NpemUoMClcbiAgICAgICAgICAgIC5vcmllbnQoXCJsZWZ0XCIpO1xuXG4gICAgICAgIHZhciBzdmcgPSBjaGFydFxuICAgICAgICAgICAgLmF0dHIoXCJ3aWR0aFwiLCBzcGFjZUZvckxhYmVscyArIGNoYXJ0V2lkdGggKyBzcGFjZUZvckxlZ2VuZClcbiAgICAgICAgICAgIC5hdHRyKFwiaGVpZ2h0XCIsIGNoYXJ0SGVpZ2h0KTtcblxuICAgICAgICAvLyBHZXQgdGhlIG5vZGVzXG4gICAgICAgIHZhciBiYXJOb2RlcyA9IHN2Zy5zZWxlY3RBbGwoXCJnXCIpXG4gICAgICAgICAgICAuZGF0YSh6aXBwZWREYXRhKVxuXG4gICAgICAgIC8vIENyZWF0ZSBiYXJzXG4gICAgICAgIHZhciBiYXIgPSBiYXJOb2Rlc1xuICAgICAgICAgICAgLmVudGVyKClcbiAgICAgICAgICAgIC5hcHBlbmQoXCJnXCIpXG4gICAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBmdW5jdGlvbihkLCBpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwidHJhbnNsYXRlKFwiICsgc3BhY2VGb3JMYWJlbHMgKyBcIixcIiArIChpICogYmFySGVpZ2h0ICsgZ2FwQmV0d2Vlbkdyb3VwcyAqICgwLjUgKyBNYXRoLmZsb29yKGkgLyBkYXRhLnNlcmllcy5sZW5ndGgpKSkgKyBcIilcIjtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIC8vIENyZWF0ZSByZWN0YW5nbGVzIG9mIHRoZSBjb3JyZWN0IHdpZHRoXG4gICAgICAgIGJhci5hcHBlbmQoXCJyZWN0XCIpXG4gICAgICAgICAgICAuYXR0cihcImZpbGxcIiwgZnVuY3Rpb24oZCwgaSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBjb2xvcihpICUgZGF0YS5zZXJpZXMubGVuZ3RoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuYXR0cihcImNsYXNzXCIsIFwiYmFyXCIpXG4gICAgICAgICAgICAuYXR0cihcIndpZHRoXCIsIHgpXG4gICAgICAgICAgICAuYXR0cihcImhlaWdodFwiLCBiYXJIZWlnaHQgLSAxKTtcblxuICAgICAgICAvLyBBZGQgdGV4dCBsYWJlbCBpbiBiYXJcbiAgICAgICAgYmFyLmFwcGVuZChcInRleHRcIilcbiAgICAgICAgICAgIC5hdHRyKFwieFwiLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHgoZCkgLSAzO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5hdHRyKFwieVwiLCBiYXJIZWlnaHQgLyAyKVxuICAgICAgICAgICAgLmF0dHIoXCJmaWxsXCIsIFwicmVkXCIpXG4gICAgICAgICAgICAuYXR0cihcImR5XCIsIFwiLjM1ZW1cIilcbiAgICAgICAgICAgIC50ZXh0KGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZDtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIC8vIERyYXcgbGFiZWxzXG4gICAgICAgIGJhci5hcHBlbmQoXCJ0ZXh0XCIpXG4gICAgICAgICAgICAuYXR0cihcImNsYXNzXCIsIFwibGFiZWxcIilcbiAgICAgICAgICAgIC5hdHRyKFwieFwiLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIC0xMDtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuYXR0cihcInlcIiwgZ3JvdXBIZWlnaHQgLyAyKVxuICAgICAgICAgICAgLmF0dHIoXCJkeVwiLCBcIi4zNWVtXCIpXG4gICAgICAgICAgICAudGV4dChmdW5jdGlvbihkLCBpKSB7XG4gICAgICAgICAgICAgICAgaWYgKGkgJSBkYXRhLnNlcmllcy5sZW5ndGggPT09IDApXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhLmxhYmVsc1tNYXRoLmZsb29yKGkgLyBkYXRhLnNlcmllcy5sZW5ndGgpXTtcbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBcIlwiXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAvLyBEZWxldGUgdGhlIGV4dHJhIG5vZGVzXG4gICAgICAgIGJhck5vZGVzLmV4aXQoKVxuICAgICAgICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgICAgICAgLnN0eWxlKHtcbiAgICAgICAgICAgICAgICBvcGFjaXR5OiAwXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnJlbW92ZSgpO1xuXG4gICAgICAgIHN2Zy5hcHBlbmQoXCJnXCIpXG4gICAgICAgICAgICAuYXR0cihcImNsYXNzXCIsIFwieSBheGlzXCIpXG4gICAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZShcIiArIHNwYWNlRm9yTGFiZWxzICsgXCIsIFwiICsgLWdhcEJldHdlZW5Hcm91cHMgLyAyICsgXCIpXCIpXG4gICAgICAgICAgICAuY2FsbCh5QXhpcyk7XG5cbiAgICAgICAgLy8gRHJhdyBsZWdlbmRcbiAgICAgICAgdmFyIGxlZ2VuZFJlY3RTaXplID0gMTgsXG4gICAgICAgICAgICBsZWdlbmRTcGFjaW5nID0gNDtcblxuICAgICAgICB2YXIgbGVnZW5kRGF0YSA9IHN2Zy5zZWxlY3RBbGwoJy5sZWdlbmQnKVxuICAgICAgICAgICAgLmRhdGEoZGF0YS5zZXJpZXMpO1xuXG4gICAgICAgIHZhciBsZWdlbmQgPSBsZWdlbmREYXRhXG4gICAgICAgICAgICAuZW50ZXIoKVxuICAgICAgICAgICAgLmFwcGVuZCgnZycpXG4gICAgICAgICAgICAuYXR0cigndHJhbnNmb3JtJywgZnVuY3Rpb24oZCwgaSkge1xuICAgICAgICAgICAgICAgIHZhciBoZWlnaHQgPSBsZWdlbmRSZWN0U2l6ZSArIGxlZ2VuZFNwYWNpbmc7XG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9IC1nYXBCZXR3ZWVuR3JvdXBzIC8gMjtcbiAgICAgICAgICAgICAgICB2YXIgaG9yeiA9IHNwYWNlRm9yTGFiZWxzICsgY2hhcnRXaWR0aCArIDQwIC0gbGVnZW5kUmVjdFNpemU7XG4gICAgICAgICAgICAgICAgdmFyIHZlcnQgPSBpICogaGVpZ2h0IC0gb2Zmc2V0O1xuICAgICAgICAgICAgICAgIHJldHVybiAndHJhbnNsYXRlKCcgKyBob3J6ICsgJywnICsgdmVydCArICcpJztcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIGxlZ2VuZC5hcHBlbmQoJ3JlY3QnKVxuICAgICAgICAgICAgLmF0dHIoJ3dpZHRoJywgbGVnZW5kUmVjdFNpemUpXG4gICAgICAgICAgICAuYXR0cignaGVpZ2h0JywgbGVnZW5kUmVjdFNpemUpXG4gICAgICAgICAgICAuc3R5bGUoJ2ZpbGwnLCBmdW5jdGlvbihkLCBpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbG9yKGkpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdHlsZSgnc3Ryb2tlJywgZnVuY3Rpb24oZCwgaSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBjb2xvcihpKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIGxlZ2VuZC5hcHBlbmQoJ3RleHQnKVxuICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ2xlZ2VuZCcpXG4gICAgICAgICAgICAuYXR0cigneCcsIGxlZ2VuZFJlY3RTaXplICsgbGVnZW5kU3BhY2luZylcbiAgICAgICAgICAgIC5hdHRyKCd5JywgbGVnZW5kUmVjdFNpemUgLSBsZWdlbmRTcGFjaW5nKVxuICAgICAgICAgICAgLnRleHQoZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBkLmxhYmVsO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgbGVnZW5kRGF0YS5leGl0KCkucmVtb3ZlKCk7XG4gICAgfVxufSgpKVxuIiwidmFyIFRyZWVtYXAgPSAoZnVuY3Rpb24oKSB7XG4gICAgdmFyIHcgPSA5NzAsXG4gICAgICAgIGggPSA1MDAsXG4gICAgICAgIHggPSBkMy5zY2FsZS5saW5lYXIoKS5yYW5nZShbMCwgd10pLFxuICAgICAgICB5ID0gZDMuc2NhbGUubGluZWFyKCkucmFuZ2UoWzAsIGhdKSxcbiAgICAgICAgY29sb3IgPSBkMy5zY2FsZS5jYXRlZ29yeTIwYygpLFxuICAgICAgICByb290LFxuICAgICAgICBub2RlLFxuICAgICAgICB0cmVlbWFwLFxuICAgICAgICBzdmc7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBzZXR0aW5nczoge1xuICAgICAgICAgICAgdGl0bGU6IFwidHJlZW1hcFRpdGxlXCIsXG4gICAgICAgICAgICBkZXNjOiBcInRyZWVtYXBEZXNjXCIsXG4gICAgICAgICAgICB0cmVlbWFwSWQ6IFwiI3RyZWVtYXBJZFwiXG4gICAgICAgIH0sXG5cbiAgICAgICAgaW5pdDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgdHJlZW1hcElkID0gdGhpcy5zZXR0aW5ncy50cmVlbWFwSWQ7XG5cbiAgICAgICAgICAgIGQzLnNlbGVjdChcIiN0cmVlbWFwVGl0bGVcIikudGV4dCh0aGlzLnNldHRpbmdzLnRpdGxlKTtcbiAgICAgICAgICAgIGQzLnNlbGVjdChcIiN0cmVlbWFwRGVzY1wiKS50ZXh0KHRoaXMuc2V0dGluZ3MuZGVzYyk7XG5cbiAgICAgICAgICAgIHRyZWVtYXAgPSBkMy5sYXlvdXQudHJlZW1hcCgpXG4gICAgICAgICAgICAgICAgLnJvdW5kKGZhbHNlKVxuICAgICAgICAgICAgICAgIC5zaXplKFt3LCBoXSlcbiAgICAgICAgICAgICAgICAuc3RpY2t5KHRydWUpXG4gICAgICAgICAgICAgICAgLnZhbHVlKGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQud2F0Y2hlcnNfY291bnQ7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHN2ZyA9IGQzLnNlbGVjdCh0cmVlbWFwSWQpLmFwcGVuZChcImRpdlwiKVxuICAgICAgICAgICAgICAgIC5hdHRyKFwiY2xhc3NcIiwgXCJjaGFydFwiKVxuICAgICAgICAgICAgICAgIC5zdHlsZShcIndpZHRoXCIsIHcgKyBcInB4XCIpXG4gICAgICAgICAgICAgICAgLnN0eWxlKFwiaGVpZ2h0XCIsIGggKyBcInB4XCIpXG4gICAgICAgICAgICAgICAgLmFwcGVuZChcInN2ZzpzdmdcIilcbiAgICAgICAgICAgICAgICAuYXR0cihcIndpZHRoXCIsIHcpXG4gICAgICAgICAgICAgICAgLmF0dHIoXCJoZWlnaHRcIiwgaClcbiAgICAgICAgICAgICAgICAuYXBwZW5kKFwic3ZnOmdcIilcbiAgICAgICAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZSguNSwuNSlcIik7XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2hvdzogZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgc2hvd0NoYXJ0KGRhdGEpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2hvd0NoYXJ0KGRhdGEpIHtcbiAgICAgICAgbm9kZSA9IHJvb3QgPSBbXTtcbiAgICAgICAgbm9kZSA9IHJvb3QgPSBVdGlscy5nZXRUcmVlRGF0YShkYXRhKTtcblxuICAgICAgICB2YXIgbm9kZXMgPSB0cmVlbWFwLm5vZGVzKHJvb3QpXG4gICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gIWQuY2hpbGRyZW47XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB2YXIgY2VsbCA9IHN2Zy5zZWxlY3RBbGwoXCJnXCIpXG4gICAgICAgICAgICAuZGF0YShub2RlcylcbiAgICAgICAgICAgIC5lbnRlcigpLmFwcGVuZChcInN2ZzpnXCIpXG4gICAgICAgICAgICAuYXR0cihcImNsYXNzXCIsIFwiY2VsbFwiKVxuICAgICAgICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBcInRyYW5zbGF0ZShcIiArIGQueCArIFwiLFwiICsgZC55ICsgXCIpXCI7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLm9uKFwiY2xpY2tcIiwgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB6b29tKG5vZGUgPT0gZC5wYXJlbnQgPyByb290IDogZC5wYXJlbnQpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgY2VsbC5hcHBlbmQoXCJzdmc6cmVjdFwiKVxuICAgICAgICAgICAgLmF0dHIoXCJ3aWR0aFwiLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGQuZHggLSAxO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5hdHRyKFwiaGVpZ2h0XCIsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZC5keSAtIDE7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnN0eWxlKFwiZmlsbFwiLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbG9yKGQucGFyZW50Lm5hbWUpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgY2VsbC5hcHBlbmQoXCJzdmc6dGV4dFwiKVxuICAgICAgICAgICAgLmF0dHIoXCJ4XCIsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZC5keCAvIDI7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmF0dHIoXCJ5XCIsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZC5keSAvIDI7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmF0dHIoXCJkeVwiLCBcIi4zNWVtXCIpXG4gICAgICAgICAgICAuYXR0cihcInRleHQtYW5jaG9yXCIsIFwibWlkZGxlXCIpXG4gICAgICAgICAgICAudGV4dChmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGQubmFtZSArIFwiIFwiICsgZC53YXRjaGVyc19jb3VudDtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuc3R5bGUoXCJvcGFjaXR5XCIsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICBkLncgPSB0aGlzLmdldENvbXB1dGVkVGV4dExlbmd0aCgpO1xuICAgICAgICAgICAgICAgIHJldHVybiBkLmR4ID4gZC53ID8gMSA6IDA7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICBkMy5zZWxlY3Qod2luZG93KS5vbihcImNsaWNrXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgem9vbShyb290KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgZDMuc2VsZWN0KFwiI3RyZWVtYXBTZWxlY3RcIikub24oXCJjaGFuZ2VcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0cmVlbWFwLnZhbHVlKHRoaXMudmFsdWUgPT0gXCJ3YXRjaGVyc1wiID8gc2l6ZSA6IGNvdW50KS5ub2Rlcyhyb290KTtcbiAgICAgICAgICAgIHpvb20obm9kZSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNpemUoZCkge1xuICAgICAgICByZXR1cm4gZC53YXRjaGVyc19jb3VudDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjb3VudChkKSB7XG4gICAgICAgIHJldHVybiBkLmZvcmtzX2NvdW50O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHpvb20oZCkge1xuICAgICAgICB2YXIga3ggPSB3IC8gZC5keCxcbiAgICAgICAgICAgIGt5ID0gaCAvIGQuZHk7XG4gICAgICAgIHguZG9tYWluKFtkLngsIGQueCArIGQuZHhdKTtcbiAgICAgICAgeS5kb21haW4oW2QueSwgZC55ICsgZC5keV0pO1xuXG4gICAgICAgIHZhciB0ID0gc3ZnLnNlbGVjdEFsbChcImcuY2VsbFwiKS50cmFuc2l0aW9uKClcbiAgICAgICAgICAgIC5kdXJhdGlvbihkMy5ldmVudC5hbHRLZXkgPyA3NTAwIDogNzUwKVxuICAgICAgICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBcInRyYW5zbGF0ZShcIiArIHgoZC54KSArIFwiLFwiICsgeShkLnkpICsgXCIpXCI7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB0LnNlbGVjdChcInJlY3RcIilcbiAgICAgICAgICAgIC5hdHRyKFwid2lkdGhcIiwgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBreCAqIGQuZHggLSAxO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5hdHRyKFwiaGVpZ2h0XCIsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ga3kgKiBkLmR5IC0gMTtcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgdC5zZWxlY3QoXCJ0ZXh0XCIpXG4gICAgICAgICAgICAuYXR0cihcInhcIiwgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBreCAqIGQuZHggLyAyO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5hdHRyKFwieVwiLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGt5ICogZC5keSAvIDI7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnN0eWxlKFwib3BhY2l0eVwiLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGt4ICogZC5keCA+IGQudyA/IDEgOiAwO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgbm9kZSA9IGQ7XG4gICAgICAgIGQzLmV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgIH1cblxufSgpKVxuIiwiKGZ1bmN0aW9uKCkge1xuICAgIHZhciBsb2FkaW5nID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJtb2RhbFwiKTtcblxuICAgIC8qKlxuICAgICAqIFNlYXJjaFxuICAgICAqL1xuICAgIFNlYXJjaGVyLmluaXQoKTtcblxuICAgIC8qKlxuICAgICAqIHN0YXJ0IEJhckNoYXJ0XG4gICAgICovXG4gICAgQmFyLnNldHRpbmdzID0ge1xuICAgICAgICB0aXRsZTogXCJUb3AxMDAgQmFyQ2hhcnRcIixcbiAgICAgICAgZGVzYzogXCJUaGlzIGlzIGEgZ29vZCBleGFtcGxlLlwiLFxuICAgICAgICBiYXJJZDogXCIjYmFySWRcIlxuICAgIH1cbiAgICBCYXIuaW5pdCgpO1xuXG4gICAgLyoqXG4gICAgICogc3RhcnQgdHJlZW1hcFxuICAgICAqL1xuICAgIFRyZWVtYXAuc2V0dGluZ3MgPSB7XG4gICAgICAgIHRpdGxlOiBcIlRvcDEwMCB0cmVlbWFwXCIsXG4gICAgICAgIGRlc2M6IFwiWW91IGNhbiBjbGljayB0aGUgYmxvY2sgdG8gem9vbSBpdC5cIixcbiAgICAgICAgdHJlZW1hcElkOiBcIiNzYWNkbFRyZWVtYXBcIlxuICAgIH1cbiAgICBUcmVlbWFwLmluaXQoKTtcblxuICAgIGZ1bmN0aW9uIHNob3codXJsKSB7XG4gICAgICAgIHZhciBsb2FkZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgbG9hZGluZy5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xuICAgICAgICB9LCAzMDApO1xuXG4gICAgICAgIGQzLmpzb24odXJsLCBmdW5jdGlvbihlcnIsIGRhdGEpIHtcbiAgICAgICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQobG9hZGVyKTtcbiAgICAgICAgICAgICAgICBsb2FkaW5nLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgICAgICAgICAgICAgICBhbGVydChcIuWKoOi9veaVsOaNruWksei0pe+8jOivt+ajgOafpeaCqOeahOe9kee7nOiuvue9ruOAglwiKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFV0aWxzLmluaXQoZGF0YSk7XG5cbiAgICAgICAgICAgIEJhci5zaG93KCk7XG4gICAgICAgICAgICBUcmVlbWFwLnNob3coKTtcblxuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KGxvYWRlcik7XG4gICAgICAgICAgICBsb2FkaW5nLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gU2VhcmNoZXIuYWRkTGlzdGVuZXIoZnVuY3Rpb24odXJsKSB7XG4gICAgLy8gICAgIHNob3codXJsKTtcbiAgICAvLyB9KVxuXG4gICAgc2hvdygnaHR0cHM6Ly9hcGkuZ2l0aHViLmNvbS9zZWFyY2gvcmVwb3NpdG9yaWVzP3E9Yml0Y29pbicpO1xufSkoKVxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
